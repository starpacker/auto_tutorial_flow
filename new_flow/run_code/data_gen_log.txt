2025-12-09 23:47:20,575 - ### PtyRAD Logger configuration ###
2025-12-09 23:47:20,576 - log_file       = 'ptyrad_log.txt'. If log_file = None, no log file will be created.
2025-12-09 23:47:20,576 - log_dir        = 'auto'. If log_dir = 'auto', then log will be saved to `output_path` or 'logs/'.
2025-12-09 23:47:20,576 - flush_file     = True. Automatically set to True if `log_file is not None`
2025-12-09 23:47:20,576 - prefix_time    = datetime. If true, preset strings ('date', 'time', 'datetime'), or a string of time format, a datetime str is prefixed to the `log_file`.
2025-12-09 23:47:20,576 - prefix_jobid   = '0'. If not 0, it'll be prefixed to the log file. This is used for hypertune mode with multiple GPUs.
2025-12-09 23:47:20,576 - append_to_file = True. If true, logs will be appended to the existing file. If false, the log file will be overwritten.
2025-12-09 23:47:20,576 - show_timestamp = True. If true, the printed information will contain a timestamp.
2025-12-09 23:47:20,576 -  
2025-12-09 23:47:20,576 - ### Setting GPU Device ###
2025-12-09 23:47:20,576 - Selected GPU device: cuda:0 (NVIDIA GeForce RTX 3090)
2025-12-09 23:47:20,576 -  
2025-12-09 23:47:20,576 - ### Loading params file ###
2025-12-09 23:47:20,629 - ### Initializing Initializer ###
2025-12-09 23:47:20,629 - init_params are displayed below:
2025-12-09 23:47:20,629 -   random_seed: None
2025-12-09 23:47:20,629 -   probe_illum_type: electron
2025-12-09 23:47:20,629 -   probe_kv: 300.0
2025-12-09 23:47:20,629 -   probe_conv_angle: 21.4
2025-12-09 23:47:20,629 -   probe_defocus: -200.0
2025-12-09 23:47:20,629 -   probe_c3: 0.0
2025-12-09 23:47:20,629 -   probe_c5: 0.0
2025-12-09 23:47:20,629 -   beam_kev: None
2025-12-09 23:47:20,629 -   probe_dRn: None
2025-12-09 23:47:20,629 -   probe_Rn: None
2025-12-09 23:47:20,629 -   probe_D_H: None
2025-12-09 23:47:20,629 -   probe_D_FZP: None
2025-12-09 23:47:20,629 -   probe_Ls: None
2025-12-09 23:47:20,629 -   meas_Npix: 256
2025-12-09 23:47:20,629 -   pos_N_scans: 4096
2025-12-09 23:47:20,629 -   pos_N_scan_slow: 64
2025-12-09 23:47:20,629 -   pos_N_scan_fast: 64
2025-12-09 23:47:20,630 -   pos_scan_step_size: 0.41
2025-12-09 23:47:20,630 -   meas_calibration: {'mode': 'fitRBF', 'value': None}
2025-12-09 23:47:20,630 -   probe_pmode_max: 4
2025-12-09 23:47:20,630 -   probe_pmode_init_pows: [0.02]
2025-12-09 23:47:20,630 -   obj_omode_max: 1
2025-12-09 23:47:20,630 -   obj_omode_init_occu: {'occu_type': 'uniform', 'init_occu': None}
2025-12-09 23:47:20,630 -   obj_Nlayer: 21
2025-12-09 23:47:20,630 -   obj_slice_thickness: 10.0
2025-12-09 23:47:20,630 -   meas_permute: None
2025-12-09 23:47:20,630 -   meas_reshape: None
2025-12-09 23:47:20,630 -   meas_flipT: None
2025-12-09 23:47:20,630 -   meas_crop: [None, None, [68, 188], [68, 188]]
2025-12-09 23:47:20,630 -   meas_pad: {'mode': 'on_the_fly', 'padding_type': 'power', 'target_Npix': 256, 'value': 0.0, 'threshold': 70.0}
2025-12-09 23:47:20,630 -   meas_resample: {'mode': None, 'scale_factors': [2.0, 2.0]}
2025-12-09 23:47:20,630 -   meas_add_source_size: None
2025-12-09 23:47:20,630 -   meas_add_detector_blur: None
2025-12-09 23:47:20,630 -   meas_remove_neg_values: {'mode': 'clip_neg', 'value': None, 'force': False}
2025-12-09 23:47:20,630 -   meas_normalization: {'mode': 'max_at_one', 'value': None}
2025-12-09 23:47:20,630 -   meas_add_poisson_noise: None
2025-12-09 23:47:20,630 -   meas_export: None
2025-12-09 23:47:20,630 -   probe_permute: None
2025-12-09 23:47:20,630 -   probe_z_shift: None
2025-12-09 23:47:20,630 -   pos_scan_flipT: None
2025-12-09 23:47:20,630 -   pos_scan_affine: None
2025-12-09 23:47:20,630 -   pos_scan_rand_std: 0.15
2025-12-09 23:47:20,630 -   obj_z_crop: None
2025-12-09 23:47:20,630 -   obj_z_pad: None
2025-12-09 23:47:20,630 -   obj_z_resample: None
2025-12-09 23:47:20,630 -   meas_source: file
2025-12-09 23:47:20,630 -   meas_params: {'path': 'sample_data_PrScO3.mat', 'key': 'dp', 'shape': None, 'offset': None, 'gap': None}
2025-12-09 23:47:20,630 -   probe_source: simu
2025-12-09 23:47:20,630 -   probe_params: None
2025-12-09 23:47:20,630 -   pos_source: simu
2025-12-09 23:47:20,630 -   pos_params: None
2025-12-09 23:47:20,630 -   obj_source: simu
2025-12-09 23:47:20,630 -   obj_params: None
2025-12-09 23:47:20,630 -   tilt_source: simu
2025-12-09 23:47:20,630 -   tilt_params: {'tilt_type': 'all', 'init_tilts': [[0.0, 0.0]]}
2025-12-09 23:47:20,631 -  
2025-12-09 23:47:20,631 - ### Initializing cache ###
2025-12-09 23:47:20,631 - use_cached_obj   = False
2025-12-09 23:47:20,631 - use_cached_probe = False
2025-12-09 23:47:20,631 - use_cached_pos   = False
2025-12-09 23:47:20,631 -  
2025-12-09 23:47:20,631 - ### Initializing measurements ###
2025-12-09 23:47:20,631 - Loading measurements from source = 'file'
2025-12-09 23:47:20,631 - Detected measurement file type = '.mat'
2025-12-09 23:47:20,631 - Detected .mat v7.3 (HDF5 format). Delegating to `load_hdf5`.
2025-12-09 23:47:24,779 - Success! Loaded .hdf5 file with key = 'dp' from path = 'sample_data_PrScO3.mat'
2025-12-09 23:47:24,779 - Imported .hdf5 data shape = (4096, 256, 256)
2025-12-09 23:47:24,780 - Imported .hdf5 data type = float64
2025-12-09 23:47:25,114 - Casting measurements dtype to float32 (single precision) for computational efficiency.
2025-12-09 23:47:25,114 - Imported meausrements shape / dtype = (4096, 256, 256), dtype = float32
2025-12-09 23:47:25,397 - Imported meausrements int. statistics (min, mean, max) = (0.0000, 3.1329, 416.8463)
2025-12-09 23:47:25,484 - Reshaping measurements into (64, 64, 256, 256) for cropping
2025-12-09 23:47:25,484 - Cropping axis ky from 68 to 188
2025-12-09 23:47:25,484 - Cropping axis kx from 68 to 188
2025-12-09 23:47:25,484 - Cropped measurements have shape (N_slow, N_fast, ky, kx) = (64, 64, 120, 120)
2025-12-09 23:47:25,484 - Update (Npix, N_scans, N_scan_slow, N_scan_fast) after the measurements cropping
2025-12-09 23:47:25,484 - Reshape measurements back to (N, ky, kx) = (4096, 120, 120)
2025-12-09 23:47:25,557 - No negative values found in measurements. Skipping non-neg correction.
2025-12-09 23:47:25,557 - Normalizing measurements with mode = 'max_at_one' and value = 'None'
2025-12-09 23:47:25,624 - Normalizing by max of the 2D mean pattern intensity: 91.590782
2025-12-09 23:47:25,840 - meausrements int. statistics (min, mean, max) = (0.0000, 0.1555, 4.5512)
2025-12-09 23:47:25,840 - Padding measurements with mode='on_the_fly', padding_type='power', target_Npix=256
2025-12-09 23:47:25,861 - Using percentile = 70.00% to create an one-hot mask for measurements amplitude background fitting
2025-12-09 23:47:25,861 - The mask has roughly 37.08 px in radius, or 0.62 of the distance from center to edge of the image
2025-12-09 23:47:25,908 - Fitted a = 23.8710, b = 1.3862 for power law decay: y = a*r^-b
2025-12-09 23:47:25,910 - Original meas int sum = 2239.2568, padded region int sum = 80.0559, or 3.58% more intensity after padding.
2025-12-09 23:47:25,910 - This percentage should be ideally less than 5%, or you should set a lower threshold to exclude more central region.
2025-12-09 23:47:25,910 - Update Npix after the measurements padding
2025-12-09 23:47:25,939 - No negative values found in measurements. Skipping non-neg correction.
2025-12-09 23:47:25,967 - Adjusting `meas_avg_sum` by adding 80.0559 for on_the_fly meas padding
2025-12-09 23:47:26,032 - meausrements int. statistics (min, mean, max) = (0.0000, 0.1555, 4.5512)
2025-12-09 23:47:26,032 - measurements                      (N, Ky, Kx) = float32, (4096, 120, 120)
2025-12-09 23:47:26,032 -  
2025-12-09 23:47:26,033 - ### Setting up calibration ###
2025-12-09 23:47:26,033 - meas_calibration mode = 'fitRBF', value = None
2025-12-09 23:47:26,033 - Using loaded raw averaged measurement (before crop/pad/resample) to fit RBF as a part of the meas calibration
2025-12-09 23:47:26,033 - Radius of fitted bright field disk (RBF) = 26.04 px with Npix = 256
2025-12-09 23:47:26,033 - Suggested probe_mask_k radius (RBF*2/Npix) > 0.2035
2025-12-09 23:47:26,033 - Fitting raw averaged measurement with center, radius, and Gaussian blur std as a sanity check
2025-12-09 23:47:26,033 - Note that the fitted Gaussian blur std (detector blur) would be affected by overlapping Bragg disks
2025-12-09 23:47:26,034 - Initial guess: center=(127.49, 127.84), radius=26.04, Gaussian blur std=0.50
2025-12-09 23:47:26,102 - Final fit: center=(127.49, 127.84), radius=26.04, Gaussian blur std=2.73
2025-12-09 23:47:26,102 - WARNING: The 'fitRBF' and 'RBF' calibration methods are highly dependent on the accuracy of user-provided experimental parameters and acquisition conditions,
2025-12-09 23:47:26,102 -          including convergence angle, kV, dose, specimen thickness, and collection angle for the estimation of RBF.
2025-12-09 23:47:26,102 -          For example, a 5-10% error in convergence angle is fairly common.
2025-12-09 23:47:26,102 -          Users are strongly advised to perform proper microscope calibration to ensure accurate results.
2025-12-09 23:47:26,102 -          These method should only be used as a rough estimate and not as a substitute for proper experimental calibration.
2025-12-09 23:47:26,102 - dx (real space pixel size of probe and object) set to 0.0936 Ang with Npix = 256
2025-12-09 23:47:26,102 - Update dx to 0.1997 Ang due to meas_crop, Npix = 120
2025-12-09 23:47:26,102 - Suggested probe_mask_k radius (RBF*2/Npix) changes to > 0.4341
2025-12-09 23:47:26,102 - Update dx to 0.0936 Ang due to meas_pad (mode = on_the_fly, padding_type = power), Npix = 256
2025-12-09 23:47:26,102 - Suggested probe_mask_k radius (RBF*2/Npix) changes to > 0.2035
2025-12-09 23:47:26,102 -  
2025-12-09 23:47:26,102 - ### Setting init_variables dict ###
2025-12-09 23:47:26,102 - Derived values given input init_params:
2025-12-09 23:47:26,102 -   kv          = 300.0 kV
2025-12-09 23:47:26,102 -   wavelength  = 0.0197 Ang
2025-12-09 23:47:26,102 -   conv_angle  = 21.4 mrad
2025-12-09 23:47:26,102 -   Npix        = 256 px
2025-12-09 23:47:26,102 -   dk          = 0.0417 Ang^-1
2025-12-09 23:47:26,102 -   kMax        = 5.3422 Ang^-1
2025-12-09 23:47:26,102 -   da          = 0.8217 mrad
2025-12-09 23:47:26,103 -   angleMax    = 105.1737 mrad
2025-12-09 23:47:26,103 -   RBF         = 26.0445 px (Inferred from the given calibration, NOT necessarily from the loaded measurement data)
2025-12-09 23:47:26,103 -   n_alpha     = 4.9147 (# conv_angle)
2025-12-09 23:47:26,103 -   dx          = 0.0936 Ang, Nyquist-limited dmin = 2*dx = 0.1872 Ang
2025-12-09 23:47:26,103 -   Rayleigh-limited resolution  = 0.5612 Ang (0.61*lambda/alpha for focused probe )
2025-12-09 23:47:26,103 -   Real space probe extent = 23.9604 Ang
2025-12-09 23:47:26,103 -  
2025-12-09 23:47:26,103 - ### Initializing probe ###
2025-12-09 23:47:26,103 - Loading probe from source = 'simu'
2025-12-09 23:47:26,103 - Using experimental parameters specified by 'init_params' for initial probe simulation.
2025-12-09 23:47:26,103 - Start simulating STEM probe
2025-12-09 23:47:26,110 -   kv          = 300.0 kV
2025-12-09 23:47:26,110 -   wavelength  = 0.0197 Ang
2025-12-09 23:47:26,110 -   conv_angle  = 21.4 mrad
2025-12-09 23:47:26,110 -   Npix        = 256 px
2025-12-09 23:47:26,110 -   dk          = 0.0417 Ang^-1
2025-12-09 23:47:26,110 -   kMax        = 5.3422 Ang^-1
2025-12-09 23:47:26,110 -   alpha_max   = 105.1700 mrad
2025-12-09 23:47:26,110 -   dx          = 0.0936 Ang, Nyquist-limited dmin = 2*dx = 0.1872 Ang
2025-12-09 23:47:26,110 -   Rayleigh-limited resolution  = 0.5612 Ang (0.61*lambda/alpha for focused probe )
2025-12-09 23:47:26,110 -   Real space probe extent = 23.9604 Ang
2025-12-09 23:47:26,111 - Start making mixed-state STEM probe with 4 incoherent probe modes
2025-12-09 23:47:26,124 - Relative power of probe modes = [0.94 0.02 0.02 0.02]
2025-12-09 23:47:26,124 - Loaded probe shape = (4, 256, 256), dtype = complex128
2025-12-09 23:47:26,125 - pmode_now: 4 and pmode_max: 4, leaving the pmode unchanged.
2025-12-09 23:47:26,127 - Orthogonalizing 4 pmodes
2025-12-09 23:47:26,132 - Sorting 4 pmodes by their intensities
2025-12-09 23:47:26,136 - sum(|probe_data|**2) = 2319.31, while meas.mean(0).sum() = 2319.31
2025-12-09 23:47:26,136 - probe                         (pmode, Ny, Nx) = complex64, (4, 256, 256)
2025-12-09 23:47:26,137 -  
2025-12-09 23:47:26,137 - ### Initializing probe positions ###
2025-12-09 23:47:26,137 - Loading probe positions from source = 'simu'
2025-12-09 23:47:26,137 - Using experimental parameters specified by 'init_params' (dx, scan_step size, N_scan_slow, N_scan_fast) for initial position simulation.
2025-12-09 23:47:26,137 - Simulating probe positions with dx = 0.0936, scan_step_size = 0.4100, N_scan_fast = 64, N_scan_slow = 64
2025-12-09 23:47:26,140 - Applying Gaussian distributed random displacement with std = 0.15 px to scan positions
2025-12-09 23:47:26,140 - crop_pos                                (N,2) = int16, (4096, 2)
2025-12-09 23:47:26,141 - crop_pos 1st and last px coords (y,x)         = ([54, 54], [331, 330])
2025-12-09 23:47:26,141 - crop_pos extent (Ang)                         = [25.92585857 25.83226341]
2025-12-09 23:47:26,141 - probe_pos_shifts                        (N,2) = float32, (4096, 2)
2025-12-09 23:47:26,141 -  
2025-12-09 23:47:26,141 - ### Initializing object ###
2025-12-09 23:47:26,141 - Loading object from source = 'simu'
2025-12-09 23:47:26,141 - Using experimental parameters specified by 'init_params' for initial object simulation.
2025-12-09 23:47:26,445 - omode_now: 1 and omode_max: 1, leaving the omode unchanged.
2025-12-09 23:47:26,460 - object                    (omode, Nz, Ny, Nx) = complex64, (1, 21, 639, 639)
2025-12-09 23:47:26,460 - object extent                 (Z, Y, X) (Ang) = [210.      59.8073  59.8073]
2025-12-09 23:47:26,460 -  
2025-12-09 23:47:26,460 - ### Initializing omode_occu from 'uniform' ###
2025-12-09 23:47:26,460 - omode_occu                            (omode) = float32, (1,)
2025-12-09 23:47:26,460 -  
2025-12-09 23:47:26,460 - ### Initializing H (Fresnel propagator) ###
2025-12-09 23:47:26,461 - Calculating H with probe_shape = [256. 256.] px, dx = 0.0936 Ang, slice_thickness = 10.0000 Ang, lambd = 0.0197 Ang
2025-12-09 23:47:26,463 - H                                    (Ky, Kx) = complex64, (256, 256)
2025-12-09 23:47:26,463 -  
2025-12-09 23:47:26,463 - ### Initializing obj tilts from = 'simu' ###
2025-12-09 23:47:26,463 - Initialized obj_tilts with init_tilts = [[0.0, 0.0]] (theta_y, theta_x) mrad
2025-12-09 23:47:26,463 - obj_tilts                              (N, 2) = float32, (1, 2)
2025-12-09 23:47:26,463 -  
2025-12-09 23:47:26,463 - ### Checking consistency between input params with the initialized variables ###
2025-12-09 23:47:26,463 - Npix, DP measurements, probe, and H shapes will be consistent as '256' during on-the-fly measurement padding
2025-12-09 23:47:26,463 - N_scans, len(meas), N_scan_slow*N_scan_fast, len(crop_pos), and len(probe_pos_shifts) are consistent as '4096'
2025-12-09 23:47:26,463 - obj.shape[0] is consistent with len(omode_occu) as '1'
2025-12-09 23:47:26,463 - obj.shape[1] is consistent with Nlayer as '21'
2025-12-09 23:47:26,464 - crop positions (yx_min=[54 54], yx_max=[587 586]) are well contained inside object canvas (Ny,Nx) = (639, 639).
2025-12-09 23:47:26,464 - obj_tilts is consistent with either 1 or N_scans
2025-12-09 23:47:26,464 - Pass the consistency check of initialized variables, initialization is done!
2025-12-09 23:47:26,464 - ### Initializing loss function ###
2025-12-09 23:47:26,464 - ### Initializing constraint function ###
2025-12-09 23:47:26,806 - ### Starting Reconstruction ###
2025-12-09 23:47:27,220 - ### Creating PyTorch 'Adam' optimizer with configs = {} ###
2025-12-09 23:47:27,220 -  
2025-12-09 23:47:27,220 - ### Generating indices, batches, and output_path ###
2025-12-09 23:47:27,224 - d90 = 91.000 px or 8.517 Ang
2025-12-09 23:47:27,224 - Selecting indices with the 'full' mode 
2025-12-09 23:47:32,521 - Generated 128 'sparse' groups of ~32 scan positions in 5.005 sec
2025-12-09 23:47:32,979 - The effective batch size (i.e., how many probe positions are simultaneously used for 1 update of ptychographic parameters) is batch_size * grad_accumulation = 32 * 1 = 32
2025-12-09 23:47:32,979 - Original recon_dir_affixes = ['default']
2025-12-09 23:47:32,979 - Expanded recon_dir_affixes = ['indices', 'meas', 'batch', 'pmode', 'omode', 'nlayer', 'lr', 'model', 'constraint', 'loss', 'affine', 'tilt']
2025-12-09 23:47:32,987 - output_path = '/home/yjh/ad_pty/code_2/output/PSO/20251209_full_N4096_dp256_sparse32_p4_1obj_21slice_dz10_plr1e-4_oalr5e-4_oplr5e-4_slr5e-4_dpblur1.0_orblur0.4_ozblur1.0_mamp0.03_4.0_oathr0.96_oposc_sng1.0_spr0.1' is generated!
2025-12-09 23:47:33,601 -  
2025-12-09 23:47:33,601 - ### Successfully copy 'PSO_reconstruct.yml' to '/home/yjh/ad_pty/code_2/output/PSO/20251209_full_N4096_dp256_sparse32_p4_1obj_21slice_dz10_plr1e-4_oalr5e-4_oplr5e-4_slr5e-4_dpblur1.0_orblur0.4_ozblur1.0_mamp0.03_4.0_oathr0.96_oposc_sng1.0_spr0.1' ###
2025-12-09 23:47:33,601 -  
2025-12-09 23:47:33,602 - ### Log file is flushed (created) as /home/yjh/ad_pty/code_2/output/PSO/20251209_full_N4096_dp256_sparse32_p4_1obj_21slice_dz10_plr1e-4_oalr5e-4_oplr5e-4_slr5e-4_dpblur1.0_orblur0.4_ozblur1.0_mamp0.03_4.0_oathr0.96_oposc_sng1.0_spr0.1/20251209_234733_ptyrad_log.txt ###
2025-12-09 23:47:33,602 -  
2025-12-09 23:47:33,602 - ### Start the PtyRAD iterative ptycho reconstruction ###
2025-12-09 23:47:33,602 -  
2025-12-09 23:47:33,602 - Iter: 1, obja.requires_grad = True
2025-12-09 23:47:33,602 - Iter: 1, objp.requires_grad = True
2025-12-09 23:47:33,602 - Iter: 1, obj_tilts.requires_grad = False
2025-12-09 23:47:33,602 - Iter: 1, slice_thickness.requires_grad = False
2025-12-09 23:47:33,602 - Iter: 1, probe.requires_grad = True
2025-12-09 23:47:33,602 - Iter: 1, probe_pos_shifts.requires_grad = True
2025-12-09 23:47:33,602 - Setting up PyTorch compiler with {'fullgraph': False, 'dynamic': None, 'backend': 'inductor', 'mode': 'default', 'options': None, 'disable': True}
2025-12-09 23:47:34,172 - Done batch 1 with 32 indices ([3333, 24, 187, 297, 329]...) in 0.566 sec
2025-12-09 23:47:37,566 - Done batch 26 with 31 indices ([3923, 14, 119, 288, 520]...) in 0.132 sec
2025-12-09 23:47:40,988 - Done batch 51 with 31 indices ([3343, 27, 240, 322, 463]...) in 0.133 sec
2025-12-09 23:47:44,557 - Done batch 77 with 32 indices ([200, 63, 163, 370, 468]...) in 0.137 sec
2025-12-09 23:47:48,015 - Done batch 102 with 34 indices ([3338, 26, 191, 299, 324]...) in 0.145 sec
2025-12-09 23:47:51,564 - Done batch 128 with 31 indices ([1303, 168, 266, 377, 470]...) in 0.133 sec
2025-12-09 23:47:51,634 - Apply ortho pmode constraint at iter 1, relative pmode power = [0.92  0.028 0.027 0.026], probe int sum = 2343.2092
2025-12-09 23:47:51,635 - Apply fix probe int constraint at iter 1, probe int sum = 2319.3125
2025-12-09 23:47:51,636 - Apply lateral (y,x) Gaussian blur with std = 0.4 px on obja at iter 1
2025-12-09 23:47:51,637 - Apply lateral (y,x) Gaussian blur with std = 0.4 px on objp at iter 1
2025-12-09 23:47:51,745 - Apply z-direction Gaussian blur with std = 1.0 px on obja at iter 1
2025-12-09 23:47:51,746 - Apply z-direction Gaussian blur with std = 1.0 px on objp at iter 1
2025-12-09 23:47:51,778 - Apply relaxed (0.1*obj + (0.9*obj_new)) mirrored amplitude constraint with scale = 0.03 and power = 4.0 on obja at iter 1. obja range becomes (0.995, 1.006)
2025-12-09 23:47:51,779 - Apply hard threshold constraint with thresh = [0.96, 1.04] on obja at iter 1
2025-12-09 23:47:51,779 - Apply hard positivity constraint on objp with 'clip_neg' mode at iter 1. Original min = -0.055. objp range becomes (0.000, 0.058)
2025-12-09 23:47:51,780 - Iter: 1, Total Loss: 0.6741, loss_single: 0.6727, loss_poissn: 0.0000, loss_pacbed: 0.0000, loss_sparse: 0.0014, loss_simlar: 0.0000, in 18.174 sec
2025-12-09 23:47:51,780 - ### Finished 1 iterations, averaged iter_t = 18.174 with std = 0.000 ###
2025-12-09 23:47:51,781 -  
2025-12-09 23:47:52,570 - ### Evaluation & Cleanup ###
### System information ###
Platform: Linux-5.4.0-216-generic-x86_64-with-glibc2.31
Operating System: Linux 5.4.0-216-generic
OS Version: #236-Ubuntu SMP Fri Apr 11 19:53:21 UTC 2025
Machine: x86_64
Processor: x86_64
Available CPU cores: 256
Total Memory: 251.75 GB
Available Memory: 189.88 GB
 
### GPU information ###
CUDA Available: True
CUDA Version: 12.8
Available CUDA GPUs: ['NVIDIA GeForce RTX 3090', 'NVIDIA GeForce RTX 3090', 'NVIDIA GeForce RTX 3090', 'NVIDIA GeForce RTX 3090', 'NVIDIA GeForce RTX 3090', 'NVIDIA GeForce RTX 3090', 'NVIDIA GeForce RTX 3090', 'NVIDIA GeForce RTX 3090']
CUDA Compute Capability: ['8.6', '8.6', '8.6', '8.6', '8.6', '8.6', '8.6', '8.6']
  INFO: For torch.compile with Triton, you'll need CUDA GPU with Compute Capability >= 7.0.
        In addition, Triton does not directly support Windows.
        For Windows users, please follow the instruction and download `triton-windows` from https://github.com/woct0rdho/triton-windows.
MIG (Multi-Instance GPU) mode = False
  INFO: MIG splits a physical GPU into multiple GPU slices, but multiGPU does not support these MIG slices.
        In addition, multiGPU is currently only available on Linux due to the limited NCCL support.
      -> If you're doing normal reconstruction/hypertune, you can safely ignore this.
      -> If you want to do multiGPU, you must provide multiple 'full' GPUs that are not in MIG mode.
 
### Python information ###
Python Executable: /home/yjh/.conda/envs/ptyrad/bin/python
Python Version: 3.12.12 | packaged by Anaconda, Inc. | (main, Oct 21 2025, 20:16:04) [GCC 11.2.0]
 
### Packages information ###
Numpy Version (metadata): 2.3.5
PyTorch Version (metadata): 2.9.1
Optuna Version (metadata): 4.6.0
Accelerate Version (metadata): 1.12.0
PtyRAD Version (ptyrad/__init__.py): 0.1.0b12
PtyRAD is located at: /home/yjh/.conda/envs/ptyrad/lib/python3.12/site-packages/ptyrad/__init__.py
 
  [DataCapture] Saved _normalize_constraint_params -> /home/yjh/new_flow/run_code/std_data/standard_data__normalize_constraint_params.pkl
  [DataCapture] Saved load_and_preprocess_data -> /home/yjh/new_flow/run_code/std_data/standard_data_load_and_preprocess_data.pkl
  [DataCapture] Saved run_inversion -> /home/yjh/new_flow/run_code/std_data/standard_data_run_inversion.pkl
  [DataCapture] Saved evaluate_results -> /home/yjh/new_flow/run_code/std_data/standard_data_evaluate_results.pkl
OPTIMIZATION_FINISHED_SUCCESSFULLY
